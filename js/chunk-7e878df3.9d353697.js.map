{"version":3,"sources":["webpack:///./node_modules/echarts/lib/chart/sankey/sankeyVisual.js","webpack:///./node_modules/echarts/lib/chart/helper/createGraphFromNodeEdge.js","webpack:///./src/page/track/components/sankey.vue?05fb","webpack:///src/page/track/components/sankey.vue","webpack:///./src/page/track/components/sankey.vue?3fef","webpack:///./src/page/track/components/sankey.vue","webpack:///./node_modules/echarts/lib/chart/sankey.js","webpack:///./node_modules/echarts/lib/data/helper/linkList.js","webpack:///./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///./node_modules/@babel/runtime/helpers/esm/objectSpread2.js","webpack:///./node_modules/echarts/lib/chart/sankey/SankeyView.js","webpack:///./node_modules/echarts/lib/visual/VisualMapping.js","webpack:///./node_modules/echarts/lib/data/Graph.js","webpack:///./node_modules/echarts/lib/chart/sankey/sankeyLayout.js","webpack:///./src/page/track/components/sankey.vue?a00f","webpack:///./node_modules/core-js/modules/es.object.keys.js","webpack:///./node_modules/echarts/lib/chart/sankey/sankeyAction.js","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./node_modules/echarts/lib/chart/sankey/SankeySeries.js","webpack:///./node_modules/echarts/lib/chart/helper/focusNodeAdjacencyAction.js","webpack:///./node_modules/core-js/modules/es.object.get-own-property-descriptors.js","webpack:///./node_modules/core-js/modules/es.object.get-own-property-descriptor.js"],"names":["VisualMapping","zrUtil","_default","ecModel","payload","eachSeriesByType","seriesModel","graph","getGraph","nodes","length","minValue","Infinity","maxValue","each","node","nodeValue","getLayout","value","mapping","type","mappingMethod","dataExtent","visual","get","mapValueToColor","mapValueToVisual","customColor","getModel","setVisual","module","exports","List","Graph","linkList","createDimensions","CoordinateSystem","createListFromArray","edges","directed","beforeLink","i","addNode","retrieve","id","name","linkNameList","validEdges","linkCount","link","source","target","addEdge","push","nodeData","coordSys","coordSysCtor","coordDimensions","dimensions","indexOf","concat","dimensionNames","initData","edgeData","mainData","struct","structAttr","datas","edge","datasAttr","update","render","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","component","echarts","sankeyLayout","sankeyVisual","registerLayout","registerVisual","DATAS","MAIN_DATA","opt","main","linkAll","data","TRANSFERABLE_METHODS","methodName","wrapMethod","curry","transferInjection","cloneShallowInjection","CHANGABLE_METHODS","changeInjection","assert","dataType","res","isMainData","extend","linkSingle","cloneShallow","getLinkedData","_defineProperty","obj","key","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","apply","_objectSpread2","arguments","forEach","getOwnPropertyDescriptors","defineProperties","graphic","nodeOpacityPath","hoverNodeOpacityPath","lineOpacityPath","hoverLineOpacityPath","getItemOpacity","item","opacityPath","getVisual","fadeOutItem","opacityRatio","el","getGraphicEl","opacity","downplay","traverse","child","setStyle","fadeInItem","highlight","SankeyShape","extendShape","shape","x1","y1","x2","y2","cpx1","cpy1","cpx2","cpy2","extent","orient","buildPath","ctx","moveTo","bezierCurveTo","lineTo","closePath","trigger","extendChartView","_model","_focusAdjacencyDisabled","api","sankeyView","group","layoutInfo","width","height","getData","removeAll","attr","x","y","eachEdge","curve","dataIndex","seriesIndex","lineStyleModel","curvature","n1Layout","node1","node1Model","dragX1","dragY1","n2Layout","node2","node2Model","dragX2","dragY2","edgeLayout","Math","max","dy","sy","ty","dx","setShape","getItemStyle","style","fill","setHoverStyle","add","setItemGraphicEl","eachNode","layout","itemModel","dragX","dragY","labelModel","labelHoverModel","rect","Rect","hoverStyle","setLabelStyle","labelFetcher","labelDataIndex","defaultText","isRectText","eachItemGraphicEl","getItemModel","drift","dirty","dispatchAction","seriesId","getRawIndex","localX","localY","ondragend","draggable","cursor","focusNodeAdjHandler","off","unfocusNodeAdjHandler","on","_clearTimer","_dispatchUnfocus","edgeModel","edgeDataIndex","_data","setClipPath","createGridClipShape","getBoundingRect","removeClipPath","dispose","self","_unfocusDelayTimer","setTimeout","clearTimeout","focusNodeAdjacency","getNodeByIndex","getEdgeByIndex","focusNodeAdj","outEdges","inEdges","unfocusNodeAdjacency","cb","rectEl","initProps","zrColor","_number","linearMap","isObject","CATEGORY_DEFAULT_VISUAL_INDEX","option","visualType","thisOption","clone","_normalizeData","normalizers","visualHandler","visualHandlers","applyVisual","getColorMapper","_doMap","normalizeVisualRange","preprocessForPiecewise","categories","preprocessForSpecifiedCategory","prototype","constructor","normalized","getNormalizer","bind","color","makeApplyVisual","isNormalized","doMapCategory","call","out","returnRGBArray","fastLerp","parsedVisual","stringify","linear","category","piecewise","result","getSpecifiedVisual","fixed","doMapFixed","colorHue","makePartialColorVisualHandler","modifyHSL","colorSaturation","colorLightness","colorAlpha","modifyAlpha","makeDoMap","liftZ","symbol","getter","setter","symbolCfg","isString","hasOwnProperty","doMapToArray","symbolSize","pieceList","hasSpecialVisual","piece","index","originIndex","categoryMap","cate","isArray","visualArr","v","setVisualToOption","pop","isCategory","doNotNeedPair","applyValue","round","loop","sourceExtent","pieceIndex","findPieceIndex","map","parse","noop","littleThan","close","a","b","listVisualTypes","visualTypes","handler","addVisualHandler","isValidType","eachVisual","callback","context","mapVisual","isPrimary","newVisual","newVal","retrieveVisuals","hasVisual","ret","h","prepareVisualTypes","types","slice","sort","type1","type2","dependsOn","visualType1","visualType2","findClosestWhenOutside","possibleI","abs","len","pieceValue","updatePossible","interval","val","newAbs","_config","__DEV__","_clazz","enableClassCheck","generateNodeKey","_directed","_nodesMap","_edgesMap","graphProto","Node","hostGraph","Edge","n1","n2","isDirected","nodesMap","rawIdx","getNodeById","edgesMap","isInstance","getEdge","breadthFirstTraverse","startNode","direction","edgeType","__visited","queue","currentNode","shift","e","otherNode","count","filterSelf","idx","degree","inDegree","outDegree","path","createGraphDataProxyMixin","hostName","dataName","getValue","dimension","getDimension","setItemVisual","ignoreParent","getItemVisual","setLayout","merge","setItemLayout","getItemLayout","getItemGraphicEl","mixin","groupData","nodeWidth","nodeGap","getViewRect","computeNodeValues","filteredNodes","iterations","nodeAlign","layoutSankey","getLayoutRect","getBoxLayoutParams","getWidth","getHeight","computeNodeBreadths","computeNodeDepths","computeEdgeDepths","value1","sum","getEdgeValue","value2","nodeRawValue","remainEdges","indegreeArr","zeroIndegrees","nextTargetNode","kx","maxNodeDepth","getRawDataItem","isItemDepth","depth","edgeIdx","indexEdge","targetNode","nodeIndex","Error","maxDepth","adjustNodeWithNodeAlign","scaleNodeBreadths","isNodeDepth","nextSourceNode","remainNodes","nodeHeight","skNodeHeight","j","moveSinksRight","nodeDepth","nodesByBreadth","prepareNodesByBreadth","initializeNodeDepth","resolveCollisions","alpha","relaxRightToLeft","relaxLeftToRight","keyAttr","groupResult","buckets","minKy","n","ky","nodeDy","edgeDy","nodeX","y0","nodeDyAttr","viewWidth","reverse","weightedTarget","isNaN","centerTarget","center","nodeY","weightedSource","centerSource","array","$","toObject","nativeKeys","fails","FAILS_ON_PRIMITIVES","stat","forced","it","registerAction","event","eachComponent","mainType","subType","query","setNodePosition","$indexOf","arrayMethodIsStrict","arrayMethodUsesToLength","nativeIndexOf","NEGATIVE_ZERO","STRICT_METHOD","USES_TO_LENGTH","ACCESSORS","1","proto","searchElement","undefined","SeriesModel","createGraphFromNodeEdge","_format","encodeHTML","Model","SankeySeries","levelModels","getInitialData","links","levels","model","customizeGetParent","parentModel","levelModel","localPosition","dataItem","getEdgeData","formatTooltip","multipleSeries","params","getDataParams","rawDataOpt","html","superCall","optionUpdated","defaultOption","zlevel","z","coordinateSystem","left","top","right","bottom","layoutIterations","label","show","position","fontSize","itemStyle","borderWidth","borderColor","lineStyle","curveness","emphasis","animationEasing","animationDuration","DESCRIPTORS","toIndexedObject","getOwnPropertyDescriptorModule","createProperty","sham","descriptor","O","f","nativeGetOwnPropertyDescriptor","FORCED"],"mappings":"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","file":"js/chunk-7e878df3.9d353697.js","sourcesContent":["\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar VisualMapping = require(\"../../visual/VisualMapping\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction _default(ecModel, payload) {\n  ecModel.eachSeriesByType('sankey', function (seriesModel) {\n    var graph = seriesModel.getGraph();\n    var nodes = graph.nodes;\n\n    if (nodes.length) {\n      var minValue = Infinity;\n      var maxValue = -Infinity;\n      zrUtil.each(nodes, function (node) {\n        var nodeValue = node.getLayout().value;\n\n        if (nodeValue < minValue) {\n          minValue = nodeValue;\n        }\n\n        if (nodeValue > maxValue) {\n          maxValue = nodeValue;\n        }\n      });\n      zrUtil.each(nodes, function (node) {\n        var mapping = new VisualMapping({\n          type: 'color',\n          mappingMethod: 'linear',\n          dataExtent: [minValue, maxValue],\n          visual: seriesModel.get('color')\n        });\n        var mapValueToColor = mapping.mapValueToVisual(node.getLayout().value);\n        var customColor = node.getModel().get('itemStyle.color');\n        customColor != null ? node.setVisual('color', customColor) : node.setVisual('color', mapValueToColor);\n      });\n    }\n  });\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar List = require(\"../../data/List\");\n\nvar Graph = require(\"../../data/Graph\");\n\nvar linkList = require(\"../../data/helper/linkList\");\n\nvar createDimensions = require(\"../../data/helper/createDimensions\");\n\nvar CoordinateSystem = require(\"../../CoordinateSystem\");\n\nvar createListFromArray = require(\"./createListFromArray\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction _default(nodes, edges, seriesModel, directed, beforeLink) {\n  // ??? TODO\n  // support dataset?\n  var graph = new Graph(directed);\n\n  for (var i = 0; i < nodes.length; i++) {\n    graph.addNode(zrUtil.retrieve( // Id, name, dataIndex\n    nodes[i].id, nodes[i].name, i), i);\n  }\n\n  var linkNameList = [];\n  var validEdges = [];\n  var linkCount = 0;\n\n  for (var i = 0; i < edges.length; i++) {\n    var link = edges[i];\n    var source = link.source;\n    var target = link.target; // addEdge may fail when source or target not exists\n\n    if (graph.addEdge(source, target, linkCount)) {\n      validEdges.push(link);\n      linkNameList.push(zrUtil.retrieve(link.id, source + ' > ' + target));\n      linkCount++;\n    }\n  }\n\n  var coordSys = seriesModel.get('coordinateSystem');\n  var nodeData;\n\n  if (coordSys === 'cartesian2d' || coordSys === 'polar') {\n    nodeData = createListFromArray(nodes, seriesModel);\n  } else {\n    var coordSysCtor = CoordinateSystem.get(coordSys);\n    var coordDimensions = coordSysCtor && coordSysCtor.type !== 'view' ? coordSysCtor.dimensions || [] : []; // FIXME: Some geo do not need `value` dimenson, whereas `calendar` needs\n    // `value` dimension, but graph need `value` dimension. It's better to\n    // uniform this behavior.\n\n    if (zrUtil.indexOf(coordDimensions, 'value') < 0) {\n      coordDimensions.concat(['value']);\n    }\n\n    var dimensionNames = createDimensions(nodes, {\n      coordDimensions: coordDimensions\n    });\n    nodeData = new List(dimensionNames, seriesModel);\n    nodeData.initData(nodes);\n  }\n\n  var edgeData = new List(['value'], seriesModel);\n  edgeData.initData(validEdges, linkNameList);\n  beforeLink && beforeLink(nodeData, edgeData);\n  linkList({\n    mainData: nodeData,\n    struct: graph,\n    structAttr: 'graph',\n    datas: {\n      node: nodeData,\n      edge: edgeData\n    },\n    datasAttr: {\n      node: 'data',\n      edge: 'edgeData'\n    }\n  }); // Update dataIndex of nodes and edges because invalid edge may be removed\n\n  graph.update();\n  return graph;\n}\n\nmodule.exports = _default;","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"sankey\"}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div id=\"sankey\">\n\n    </div>\n</template>\n\n<script>\n    import _ from 'lodash'\n    import echarts from 'echarts/lib/echarts';\n    import 'echarts/lib/chart/sankey'\n    import TrackJSON from '@/data/track'\n    // import { scaleLinear } from 'd3'\n\n\n    const DIM = ['age_range', 'xb','period','origin', 'tran', ]\n\n    const ITEM_STYLE = {\n        xb(){\n            return {\n                '': {\n                    color: '#3a7ba5',\n                },\n                '': {\n                    color: '#9d4da7',\n                },\n            }\n        }\n    }\n\n    const TRAN_ORDER = {\n        '/': 0,\n        '': 1,\n        '3A109': 2,\n        '': 3,\n        '': 4,\n        '': 5,\n    }\n\n    const SORT_FUN = {\n        'age_range': data => {\n            return _.orderBy(data, d => {\n                switch(d.name) {\n                    case '/(0~15)': return 0\n                    case '(16~30)': return 1\n                    case '(30~45)': return 2\n                    case '(45~60)': return 3\n                    case '(>60)': return 4\n                }\n            })\n        },\n        'origin': data => {\n            return data.sort(a => COUNTRY.indexOf(a.name) !== -1 ? 1 : -1)\n        },\n        'tran': data => {\n            return _.orderBy(data, d => TRAN_ORDER[d.name])\n        },\n        'period': data => {\n            return _.orderBy(data, d => {\n                switch(d.name) {\n                    case '(~1/23)': return 0\n                    case '(1/23~2/6)': return 1\n                    case '(2/6~2/20)': return 2\n                    case '(2/20~)': return 3\n                }\n            })\n        }\n    }\n\n    const COUNTRY = [\"\", \"\", \"\", \"\", \"\",\n        \"\", \"\", \"\", \"\", \"\", \"\",\n        \"\", \"\"]\n\n    const getAgeCategory = age => {\n        if (age >= 0 && age <= 15) {\n            return '/(0~15)'\n        }\n        if (age > 15 && age <= 30) {\n            return '(16~30)'\n        }\n        if (age > 30 && age <= 45) {\n            return '(30~45)'\n        }\n        if (age > 45 && age <= 60) {\n            return '(45~60)'\n        }\n        if (age > 60) {\n            return '(>60)'\n        }\n    }\n\n    const ChinaPeriod = ['2020/1/23', '2020/2/6', '2020/2/20']\n        .map(d => new Date(d).getTime())\n\n    const getPeriod = date => {\n        const newDate = new Date(date).getTime()\n        if (newDate <= ChinaPeriod[0]) {\n            return '(~1/23)'\n        }\n        if (newDate > ChinaPeriod[0] && newDate < ChinaPeriod[1]) {\n            return '(1/23~2/6)'\n        }\n        if (newDate > ChinaPeriod[1] && newDate < ChinaPeriod[2]) {\n            return '(2/6~2/20)'\n        }\n        if (newDate >= ChinaPeriod[2]) {\n            return '(2/20~)'\n        }\n        \n    }\n\n    // const scale = scaleLinear()\n    //     .domain([1, 200])\n    //     .range(['#87cc7c', '#966d4b','#935740', '#69277e', '#9d4da7'])\n\n    export default {\n        name: 'SanKey',\n        methods: {\n            getNodes(data) {\n                return DIM.reduce((arr, key) => {\n                    const styles = ITEM_STYLE[key] && ITEM_STYLE[key]() || {}\n                    let tempArr =  _.chain(data)\n                        .map(d => {\n                            return {\n                                name: d[key],\n                                itemStyle: styles[d[key]],\n                            }\n                        })\n                        .uniqBy('name')\n                        .value()\n                        tempArr = SORT_FUN[key] ? SORT_FUN[key](tempArr) : tempArr\n                    return arr.concat(tempArr)\n                }, [])\n            },\n            getLinks(data) {\n                const links = [];\n                DIM.forEach((d, i, arr) => {\n                    if (i === arr.length - 1) return\n                    data.forEach(d1 => {\n                        const source = d1[d]\n                        const target = d1[arr[i + 1]]\n                        const value = data.filter(d2 => d2[d] === source\n                            && d2[arr[i + 1]] === target\n                            ).length\n                        links.push({\n                            source,\n                            target,\n                            value,\n                            lineStyle: {\n                                // color: scale(value),\n                            },\n                        })\n                    })\n                })\n\n                return _.uniqWith(links, _.isEqual)\n            },\n            initData() {\n                const data = _.chain(TrackJSON)\n                    // .slice(0, 400)\n                    .filter(d => d.track.length)\n                    .map(d => {\n                        const {track, nl} = d\n                        let tran = track.length ? track[track.length - 1].tran : ''\n                        tran = tran.indexOf('') !== -1 ? '' : tran\n                        tran = /()|()|()|()/.test(tran) ? '/' : tran\n                        tran = /()|()/.test(tran) ? '' : tran\n                        const age_range = getAgeCategory(+nl)\n                        return _.pick({\n                            ...d,\n                            tran: tran || '',\n                            age_range,\n                            period: getPeriod(d.track[d.track.length - 1].time)\n                        },\n                        DIM\n                        )\n                    })\n                    .value()\n                \n                const nodes = this.getNodes(data)\n                const links = this.getLinks(data)\n                return {nodes, links}\n            },\n            initChart() {\n                const { nodes, links } = this.initData()\n                \n                const option = {\n                    color: ['#87cc7c', '#966d4b', '#935740', '#69277e', '#9d4da7'],\n                    tooltip: {\n                        trigger: \"item\",\n                        triggerOn: \"mousemove\"\n                    },\n                    series: {\n                        type: \"sankey\",\n                        left: 10,\n                        right: 50,\n                        nodeGap: 1,\n                        layoutIterations: 0,\n                        data: nodes, // \n                        links: links, // \n                        draggable: false,\n                        focusNodeAdjacency: \"allEdges\", // allEdges\n                        label: {\n                            fontSize: 10,\n                            color: \"rgba(255,255,255,.8)\"\n                        },\n                        lineStyle: {\n                            color: 'source',\n                            curveness: 0.5\n                        },\n                    }\n                };\n\n                const myChart = echarts.init(document.getElementById('sankey'), 'light');\n                myChart.setOption(option)\n            }\n        },\n        mounted() {\n            setTimeout(this.initChart);\n        }\n    }\n</script>\n\n<style lang=\"less\" scoped>\n    #sankey{\n        height: 600px;\n    }\n</style>","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sankey.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sankey.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./sankey.vue?vue&type=template&id=e0578438&scoped=true&\"\nimport script from \"./sankey.vue?vue&type=script&lang=js&\"\nexport * from \"./sankey.vue?vue&type=script&lang=js&\"\nimport style0 from \"./sankey.vue?vue&type=style&index=0&id=e0578438&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e0578438\",\n  null\n  \n)\n\nexport default component.exports","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../echarts\");\n\nrequire(\"./sankey/SankeySeries\");\n\nrequire(\"./sankey/SankeyView\");\n\nrequire(\"./sankey/sankeyAction\");\n\nvar sankeyLayout = require(\"./sankey/sankeyLayout\");\n\nvar sankeyVisual = require(\"./sankey/sankeyVisual\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\necharts.registerLayout(sankeyLayout);\necharts.registerVisual(sankeyVisual);","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * Link lists and struct (graph or tree)\n */\nvar each = zrUtil.each;\nvar DATAS = '\\0__link_datas';\nvar MAIN_DATA = '\\0__link_mainData'; // Caution:\n// In most case, either list or its shallow clones (see list.cloneShallow)\n// is active in echarts process. So considering heap memory consumption,\n// we do not clone tree or graph, but share them among list and its shallow clones.\n// But in some rare case, we have to keep old list (like do animation in chart). So\n// please take care that both the old list and the new list share the same tree/graph.\n\n/**\n * @param {Object} opt\n * @param {module:echarts/data/List} opt.mainData\n * @param {Object} [opt.struct] For example, instance of Graph or Tree.\n * @param {string} [opt.structAttr] designation: list[structAttr] = struct;\n * @param {Object} [opt.datas] {dataType: data},\n *                 like: {node: nodeList, edge: edgeList}.\n *                 Should contain mainData.\n * @param {Object} [opt.datasAttr] {dataType: attr},\n *                 designation: struct[datasAttr[dataType]] = list;\n */\n\nfunction linkList(opt) {\n  var mainData = opt.mainData;\n  var datas = opt.datas;\n\n  if (!datas) {\n    datas = {\n      main: mainData\n    };\n    opt.datasAttr = {\n      main: 'data'\n    };\n  }\n\n  opt.datas = opt.mainData = null;\n  linkAll(mainData, datas, opt); // Porxy data original methods.\n\n  each(datas, function (data) {\n    each(mainData.TRANSFERABLE_METHODS, function (methodName) {\n      data.wrapMethod(methodName, zrUtil.curry(transferInjection, opt));\n    });\n  }); // Beyond transfer, additional features should be added to `cloneShallow`.\n\n  mainData.wrapMethod('cloneShallow', zrUtil.curry(cloneShallowInjection, opt)); // Only mainData trigger change, because struct.update may trigger\n  // another changable methods, which may bring about dead lock.\n\n  each(mainData.CHANGABLE_METHODS, function (methodName) {\n    mainData.wrapMethod(methodName, zrUtil.curry(changeInjection, opt));\n  }); // Make sure datas contains mainData.\n\n  zrUtil.assert(datas[mainData.dataType] === mainData);\n}\n\nfunction transferInjection(opt, res) {\n  if (isMainData(this)) {\n    // Transfer datas to new main data.\n    var datas = zrUtil.extend({}, this[DATAS]);\n    datas[this.dataType] = res;\n    linkAll(res, datas, opt);\n  } else {\n    // Modify the reference in main data to point newData.\n    linkSingle(res, this.dataType, this[MAIN_DATA], opt);\n  }\n\n  return res;\n}\n\nfunction changeInjection(opt, res) {\n  opt.struct && opt.struct.update(this);\n  return res;\n}\n\nfunction cloneShallowInjection(opt, res) {\n  // cloneShallow, which brings about some fragilities, may be inappropriate\n  // to be exposed as an API. So for implementation simplicity we can make\n  // the restriction that cloneShallow of not-mainData should not be invoked\n  // outside, but only be invoked here.\n  each(res[DATAS], function (data, dataType) {\n    data !== res && linkSingle(data.cloneShallow(), dataType, res, opt);\n  });\n  return res;\n}\n/**\n * Supplement method to List.\n *\n * @public\n * @param {string} [dataType] If not specified, return mainData.\n * @return {module:echarts/data/List}\n */\n\n\nfunction getLinkedData(dataType) {\n  var mainData = this[MAIN_DATA];\n  return dataType == null || mainData == null ? mainData : mainData[DATAS][dataType];\n}\n\nfunction isMainData(data) {\n  return data[MAIN_DATA] === data;\n}\n\nfunction linkAll(mainData, datas, opt) {\n  mainData[DATAS] = {};\n  each(datas, function (data, dataType) {\n    linkSingle(data, dataType, mainData, opt);\n  });\n}\n\nfunction linkSingle(data, dataType, mainData, opt) {\n  mainData[DATAS][dataType] = data;\n  data[MAIN_DATA] = mainData;\n  data.dataType = dataType;\n\n  if (opt.struct) {\n    data[opt.structAttr] = opt.struct;\n    opt.struct[opt.datasAttr[dataType]] = data;\n  } // Supplement method.\n\n\n  data.getLinkedData = getLinkedData;\n}\n\nvar _default = linkList;\nmodule.exports = _default;","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"./defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar graphic = require(\"../../util/graphic\");\n\nvar echarts = require(\"../../echarts\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar nodeOpacityPath = ['itemStyle', 'opacity'];\nvar hoverNodeOpacityPath = ['emphasis', 'itemStyle', 'opacity'];\nvar lineOpacityPath = ['lineStyle', 'opacity'];\nvar hoverLineOpacityPath = ['emphasis', 'lineStyle', 'opacity'];\n\nfunction getItemOpacity(item, opacityPath) {\n  return item.getVisual('opacity') || item.getModel().get(opacityPath);\n}\n\nfunction fadeOutItem(item, opacityPath, opacityRatio) {\n  var el = item.getGraphicEl();\n  var opacity = getItemOpacity(item, opacityPath);\n\n  if (opacityRatio != null) {\n    opacity == null && (opacity = 1);\n    opacity *= opacityRatio;\n  }\n\n  el.downplay && el.downplay();\n  el.traverse(function (child) {\n    if (child.type !== 'group') {\n      child.setStyle('opacity', opacity);\n    }\n  });\n}\n\nfunction fadeInItem(item, opacityPath) {\n  var opacity = getItemOpacity(item, opacityPath);\n  var el = item.getGraphicEl();\n  el.traverse(function (child) {\n    if (child.type !== 'group') {\n      child.setStyle('opacity', opacity);\n    }\n  }); // Support emphasis here.\n\n  el.highlight && el.highlight();\n}\n\nvar SankeyShape = graphic.extendShape({\n  shape: {\n    x1: 0,\n    y1: 0,\n    x2: 0,\n    y2: 0,\n    cpx1: 0,\n    cpy1: 0,\n    cpx2: 0,\n    cpy2: 0,\n    extent: 0,\n    orient: ''\n  },\n  buildPath: function (ctx, shape) {\n    var extent = shape.extent;\n    ctx.moveTo(shape.x1, shape.y1);\n    ctx.bezierCurveTo(shape.cpx1, shape.cpy1, shape.cpx2, shape.cpy2, shape.x2, shape.y2);\n\n    if (shape.orient === 'vertical') {\n      ctx.lineTo(shape.x2 + extent, shape.y2);\n      ctx.bezierCurveTo(shape.cpx2 + extent, shape.cpy2, shape.cpx1 + extent, shape.cpy1, shape.x1 + extent, shape.y1);\n    } else {\n      ctx.lineTo(shape.x2, shape.y2 + extent);\n      ctx.bezierCurveTo(shape.cpx2, shape.cpy2 + extent, shape.cpx1, shape.cpy1 + extent, shape.x1, shape.y1 + extent);\n    }\n\n    ctx.closePath();\n  },\n  highlight: function () {\n    this.trigger('emphasis');\n  },\n  downplay: function () {\n    this.trigger('normal');\n  }\n});\n\nvar _default = echarts.extendChartView({\n  type: 'sankey',\n\n  /**\n   * @private\n   * @type {module:echarts/chart/sankey/SankeySeries}\n   */\n  _model: null,\n\n  /**\n   * @private\n   * @type {boolean}\n   */\n  _focusAdjacencyDisabled: false,\n  render: function (seriesModel, ecModel, api) {\n    var sankeyView = this;\n    var graph = seriesModel.getGraph();\n    var group = this.group;\n    var layoutInfo = seriesModel.layoutInfo; // view width\n\n    var width = layoutInfo.width; // view height\n\n    var height = layoutInfo.height;\n    var nodeData = seriesModel.getData();\n    var edgeData = seriesModel.getData('edge');\n    var orient = seriesModel.get('orient');\n    this._model = seriesModel;\n    group.removeAll();\n    group.attr('position', [layoutInfo.x, layoutInfo.y]); // generate a bezire Curve for each edge\n\n    graph.eachEdge(function (edge) {\n      var curve = new SankeyShape();\n      curve.dataIndex = edge.dataIndex;\n      curve.seriesIndex = seriesModel.seriesIndex;\n      curve.dataType = 'edge';\n      var lineStyleModel = edge.getModel('lineStyle');\n      var curvature = lineStyleModel.get('curveness');\n      var n1Layout = edge.node1.getLayout();\n      var node1Model = edge.node1.getModel();\n      var dragX1 = node1Model.get('localX');\n      var dragY1 = node1Model.get('localY');\n      var n2Layout = edge.node2.getLayout();\n      var node2Model = edge.node2.getModel();\n      var dragX2 = node2Model.get('localX');\n      var dragY2 = node2Model.get('localY');\n      var edgeLayout = edge.getLayout();\n      var x1;\n      var y1;\n      var x2;\n      var y2;\n      var cpx1;\n      var cpy1;\n      var cpx2;\n      var cpy2;\n      curve.shape.extent = Math.max(1, edgeLayout.dy);\n      curve.shape.orient = orient;\n\n      if (orient === 'vertical') {\n        x1 = (dragX1 != null ? dragX1 * width : n1Layout.x) + edgeLayout.sy;\n        y1 = (dragY1 != null ? dragY1 * height : n1Layout.y) + n1Layout.dy;\n        x2 = (dragX2 != null ? dragX2 * width : n2Layout.x) + edgeLayout.ty;\n        y2 = dragY2 != null ? dragY2 * height : n2Layout.y;\n        cpx1 = x1;\n        cpy1 = y1 * (1 - curvature) + y2 * curvature;\n        cpx2 = x2;\n        cpy2 = y1 * curvature + y2 * (1 - curvature);\n      } else {\n        x1 = (dragX1 != null ? dragX1 * width : n1Layout.x) + n1Layout.dx;\n        y1 = (dragY1 != null ? dragY1 * height : n1Layout.y) + edgeLayout.sy;\n        x2 = dragX2 != null ? dragX2 * width : n2Layout.x;\n        y2 = (dragY2 != null ? dragY2 * height : n2Layout.y) + edgeLayout.ty;\n        cpx1 = x1 * (1 - curvature) + x2 * curvature;\n        cpy1 = y1;\n        cpx2 = x1 * curvature + x2 * (1 - curvature);\n        cpy2 = y2;\n      }\n\n      curve.setShape({\n        x1: x1,\n        y1: y1,\n        x2: x2,\n        y2: y2,\n        cpx1: cpx1,\n        cpy1: cpy1,\n        cpx2: cpx2,\n        cpy2: cpy2\n      });\n      curve.setStyle(lineStyleModel.getItemStyle()); // Special color, use source node color or target node color\n\n      switch (curve.style.fill) {\n        case 'source':\n          curve.style.fill = edge.node1.getVisual('color');\n          break;\n\n        case 'target':\n          curve.style.fill = edge.node2.getVisual('color');\n          break;\n      }\n\n      graphic.setHoverStyle(curve, edge.getModel('emphasis.lineStyle').getItemStyle());\n      group.add(curve);\n      edgeData.setItemGraphicEl(edge.dataIndex, curve);\n    }); // Generate a rect for each node\n\n    graph.eachNode(function (node) {\n      var layout = node.getLayout();\n      var itemModel = node.getModel();\n      var dragX = itemModel.get('localX');\n      var dragY = itemModel.get('localY');\n      var labelModel = itemModel.getModel('label');\n      var labelHoverModel = itemModel.getModel('emphasis.label');\n      var rect = new graphic.Rect({\n        shape: {\n          x: dragX != null ? dragX * width : layout.x,\n          y: dragY != null ? dragY * height : layout.y,\n          width: layout.dx,\n          height: layout.dy\n        },\n        style: itemModel.getModel('itemStyle').getItemStyle()\n      });\n      var hoverStyle = node.getModel('emphasis.itemStyle').getItemStyle();\n      graphic.setLabelStyle(rect.style, hoverStyle, labelModel, labelHoverModel, {\n        labelFetcher: seriesModel,\n        labelDataIndex: node.dataIndex,\n        defaultText: node.id,\n        isRectText: true\n      });\n      rect.setStyle('fill', node.getVisual('color'));\n      graphic.setHoverStyle(rect, hoverStyle);\n      group.add(rect);\n      nodeData.setItemGraphicEl(node.dataIndex, rect);\n      rect.dataType = 'node';\n    });\n    nodeData.eachItemGraphicEl(function (el, dataIndex) {\n      var itemModel = nodeData.getItemModel(dataIndex);\n\n      if (itemModel.get('draggable')) {\n        el.drift = function (dx, dy) {\n          sankeyView._focusAdjacencyDisabled = true;\n          this.shape.x += dx;\n          this.shape.y += dy;\n          this.dirty();\n          api.dispatchAction({\n            type: 'dragNode',\n            seriesId: seriesModel.id,\n            dataIndex: nodeData.getRawIndex(dataIndex),\n            localX: this.shape.x / width,\n            localY: this.shape.y / height\n          });\n        };\n\n        el.ondragend = function () {\n          sankeyView._focusAdjacencyDisabled = false;\n        };\n\n        el.draggable = true;\n        el.cursor = 'move';\n      }\n\n      el.highlight = function () {\n        this.trigger('emphasis');\n      };\n\n      el.downplay = function () {\n        this.trigger('normal');\n      };\n\n      el.focusNodeAdjHandler && el.off('mouseover', el.focusNodeAdjHandler);\n      el.unfocusNodeAdjHandler && el.off('mouseout', el.unfocusNodeAdjHandler);\n\n      if (itemModel.get('focusNodeAdjacency')) {\n        el.on('mouseover', el.focusNodeAdjHandler = function () {\n          if (!sankeyView._focusAdjacencyDisabled) {\n            sankeyView._clearTimer();\n\n            api.dispatchAction({\n              type: 'focusNodeAdjacency',\n              seriesId: seriesModel.id,\n              dataIndex: el.dataIndex\n            });\n          }\n        });\n        el.on('mouseout', el.unfocusNodeAdjHandler = function () {\n          if (!sankeyView._focusAdjacencyDisabled) {\n            sankeyView._dispatchUnfocus(api);\n          }\n        });\n      }\n    });\n    edgeData.eachItemGraphicEl(function (el, dataIndex) {\n      var edgeModel = edgeData.getItemModel(dataIndex);\n      el.focusNodeAdjHandler && el.off('mouseover', el.focusNodeAdjHandler);\n      el.unfocusNodeAdjHandler && el.off('mouseout', el.unfocusNodeAdjHandler);\n\n      if (edgeModel.get('focusNodeAdjacency')) {\n        el.on('mouseover', el.focusNodeAdjHandler = function () {\n          if (!sankeyView._focusAdjacencyDisabled) {\n            sankeyView._clearTimer();\n\n            api.dispatchAction({\n              type: 'focusNodeAdjacency',\n              seriesId: seriesModel.id,\n              edgeDataIndex: el.dataIndex\n            });\n          }\n        });\n        el.on('mouseout', el.unfocusNodeAdjHandler = function () {\n          if (!sankeyView._focusAdjacencyDisabled) {\n            sankeyView._dispatchUnfocus(api);\n          }\n        });\n      }\n    });\n\n    if (!this._data && seriesModel.get('animation')) {\n      group.setClipPath(createGridClipShape(group.getBoundingRect(), seriesModel, function () {\n        group.removeClipPath();\n      }));\n    }\n\n    this._data = seriesModel.getData();\n  },\n  dispose: function () {\n    this._clearTimer();\n  },\n  _dispatchUnfocus: function (api) {\n    var self = this;\n\n    this._clearTimer();\n\n    this._unfocusDelayTimer = setTimeout(function () {\n      self._unfocusDelayTimer = null;\n      api.dispatchAction({\n        type: 'unfocusNodeAdjacency',\n        seriesId: self._model.id\n      });\n    }, 500);\n  },\n  _clearTimer: function () {\n    if (this._unfocusDelayTimer) {\n      clearTimeout(this._unfocusDelayTimer);\n      this._unfocusDelayTimer = null;\n    }\n  },\n  focusNodeAdjacency: function (seriesModel, ecModel, api, payload) {\n    var data = seriesModel.getData();\n    var graph = data.graph;\n    var dataIndex = payload.dataIndex;\n    var itemModel = data.getItemModel(dataIndex);\n    var edgeDataIndex = payload.edgeDataIndex;\n\n    if (dataIndex == null && edgeDataIndex == null) {\n      return;\n    }\n\n    var node = graph.getNodeByIndex(dataIndex);\n    var edge = graph.getEdgeByIndex(edgeDataIndex);\n    graph.eachNode(function (node) {\n      fadeOutItem(node, nodeOpacityPath, 0.1);\n    });\n    graph.eachEdge(function (edge) {\n      fadeOutItem(edge, lineOpacityPath, 0.1);\n    });\n\n    if (node) {\n      fadeInItem(node, hoverNodeOpacityPath);\n      var focusNodeAdj = itemModel.get('focusNodeAdjacency');\n\n      if (focusNodeAdj === 'outEdges') {\n        zrUtil.each(node.outEdges, function (edge) {\n          if (edge.dataIndex < 0) {\n            return;\n          }\n\n          fadeInItem(edge, hoverLineOpacityPath);\n          fadeInItem(edge.node2, hoverNodeOpacityPath);\n        });\n      } else if (focusNodeAdj === 'inEdges') {\n        zrUtil.each(node.inEdges, function (edge) {\n          if (edge.dataIndex < 0) {\n            return;\n          }\n\n          fadeInItem(edge, hoverLineOpacityPath);\n          fadeInItem(edge.node1, hoverNodeOpacityPath);\n        });\n      } else if (focusNodeAdj === 'allEdges') {\n        zrUtil.each(node.edges, function (edge) {\n          if (edge.dataIndex < 0) {\n            return;\n          }\n\n          fadeInItem(edge, hoverLineOpacityPath);\n          edge.node1 !== node && fadeInItem(edge.node1, hoverNodeOpacityPath);\n          edge.node2 !== node && fadeInItem(edge.node2, hoverNodeOpacityPath);\n        });\n      }\n    }\n\n    if (edge) {\n      fadeInItem(edge, hoverLineOpacityPath);\n      fadeInItem(edge.node1, hoverNodeOpacityPath);\n      fadeInItem(edge.node2, hoverNodeOpacityPath);\n    }\n  },\n  unfocusNodeAdjacency: function (seriesModel, ecModel, api, payload) {\n    var graph = seriesModel.getGraph();\n    graph.eachNode(function (node) {\n      fadeOutItem(node, nodeOpacityPath);\n    });\n    graph.eachEdge(function (edge) {\n      fadeOutItem(edge, lineOpacityPath);\n    });\n  }\n}); // Add animation to the view\n\n\nfunction createGridClipShape(rect, seriesModel, cb) {\n  var rectEl = new graphic.Rect({\n    shape: {\n      x: rect.x - 10,\n      y: rect.y - 10,\n      width: 0,\n      height: rect.height + 20\n    }\n  });\n  graphic.initProps(rectEl, {\n    shape: {\n      width: rect.width + 20\n    }\n  }, seriesModel, cb);\n  return rectEl;\n}\n\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar zrColor = require(\"zrender/lib/tool/color\");\n\nvar _number = require(\"../util/number\");\n\nvar linearMap = _number.linearMap;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar each = zrUtil.each;\nvar isObject = zrUtil.isObject;\nvar CATEGORY_DEFAULT_VISUAL_INDEX = -1;\n/**\n * @param {Object} option\n * @param {string} [option.type] See visualHandlers.\n * @param {string} [option.mappingMethod] 'linear' or 'piecewise' or 'category' or 'fixed'\n * @param {Array.<number>=} [option.dataExtent] [minExtent, maxExtent],\n *                                              required when mappingMethod is 'linear'\n * @param {Array.<Object>=} [option.pieceList] [\n *                                             {value: someValue},\n *                                             {interval: [min1, max1], visual: {...}},\n *                                             {interval: [min2, max2]}\n *                                             ],\n *                                            required when mappingMethod is 'piecewise'.\n *                                            Visual for only each piece can be specified.\n * @param {Array.<string|Object>=} [option.categories] ['cate1', 'cate2']\n *                                            required when mappingMethod is 'category'.\n *                                            If no option.categories, categories is set\n *                                            as [0, 1, 2, ...].\n * @param {boolean} [option.loop=false] Whether loop mapping when mappingMethod is 'category'.\n * @param {(Array|Object|*)} [option.visual]  Visual data.\n *                                            when mappingMethod is 'category',\n *                                            visual data can be array or object\n *                                            (like: {cate1: '#222', none: '#fff'})\n *                                            or primary types (which represents\n *                                            defualt category visual), otherwise visual\n *                                            can be array or primary (which will be\n *                                            normalized to array).\n *\n */\n\nvar VisualMapping = function (option) {\n  var mappingMethod = option.mappingMethod;\n  var visualType = option.type;\n  /**\n   * @readOnly\n   * @type {Object}\n   */\n\n  var thisOption = this.option = zrUtil.clone(option);\n  /**\n   * @readOnly\n   * @type {string}\n   */\n\n  this.type = visualType;\n  /**\n   * @readOnly\n   * @type {string}\n   */\n\n  this.mappingMethod = mappingMethod;\n  /**\n   * @private\n   * @type {Function}\n   */\n\n  this._normalizeData = normalizers[mappingMethod];\n  var visualHandler = visualHandlers[visualType];\n  /**\n   * @public\n   * @type {Function}\n   */\n\n  this.applyVisual = visualHandler.applyVisual;\n  /**\n   * @public\n   * @type {Function}\n   */\n\n  this.getColorMapper = visualHandler.getColorMapper;\n  /**\n   * @private\n   * @type {Function}\n   */\n\n  this._doMap = visualHandler._doMap[mappingMethod];\n\n  if (mappingMethod === 'piecewise') {\n    normalizeVisualRange(thisOption);\n    preprocessForPiecewise(thisOption);\n  } else if (mappingMethod === 'category') {\n    thisOption.categories ? preprocessForSpecifiedCategory(thisOption) // categories is ordinal when thisOption.categories not specified,\n    // which need no more preprocess except normalize visual.\n    : normalizeVisualRange(thisOption, true);\n  } else {\n    // mappingMethod === 'linear' or 'fixed'\n    zrUtil.assert(mappingMethod !== 'linear' || thisOption.dataExtent);\n    normalizeVisualRange(thisOption);\n  }\n};\n\nVisualMapping.prototype = {\n  constructor: VisualMapping,\n  mapValueToVisual: function (value) {\n    var normalized = this._normalizeData(value);\n\n    return this._doMap(normalized, value);\n  },\n  getNormalizer: function () {\n    return zrUtil.bind(this._normalizeData, this);\n  }\n};\nvar visualHandlers = VisualMapping.visualHandlers = {\n  color: {\n    applyVisual: makeApplyVisual('color'),\n\n    /**\n     * Create a mapper function\n     * @return {Function}\n     */\n    getColorMapper: function () {\n      var thisOption = this.option;\n      return zrUtil.bind(thisOption.mappingMethod === 'category' ? function (value, isNormalized) {\n        !isNormalized && (value = this._normalizeData(value));\n        return doMapCategory.call(this, value);\n      } : function (value, isNormalized, out) {\n        // If output rgb array\n        // which will be much faster and useful in pixel manipulation\n        var returnRGBArray = !!out;\n        !isNormalized && (value = this._normalizeData(value));\n        out = zrColor.fastLerp(value, thisOption.parsedVisual, out);\n        return returnRGBArray ? out : zrColor.stringify(out, 'rgba');\n      }, this);\n    },\n    _doMap: {\n      linear: function (normalized) {\n        return zrColor.stringify(zrColor.fastLerp(normalized, this.option.parsedVisual), 'rgba');\n      },\n      category: doMapCategory,\n      piecewise: function (normalized, value) {\n        var result = getSpecifiedVisual.call(this, value);\n\n        if (result == null) {\n          result = zrColor.stringify(zrColor.fastLerp(normalized, this.option.parsedVisual), 'rgba');\n        }\n\n        return result;\n      },\n      fixed: doMapFixed\n    }\n  },\n  colorHue: makePartialColorVisualHandler(function (color, value) {\n    return zrColor.modifyHSL(color, value);\n  }),\n  colorSaturation: makePartialColorVisualHandler(function (color, value) {\n    return zrColor.modifyHSL(color, null, value);\n  }),\n  colorLightness: makePartialColorVisualHandler(function (color, value) {\n    return zrColor.modifyHSL(color, null, null, value);\n  }),\n  colorAlpha: makePartialColorVisualHandler(function (color, value) {\n    return zrColor.modifyAlpha(color, value);\n  }),\n  opacity: {\n    applyVisual: makeApplyVisual('opacity'),\n    _doMap: makeDoMap([0, 1])\n  },\n  liftZ: {\n    applyVisual: makeApplyVisual('liftZ'),\n    _doMap: {\n      linear: doMapFixed,\n      category: doMapFixed,\n      piecewise: doMapFixed,\n      fixed: doMapFixed\n    }\n  },\n  symbol: {\n    applyVisual: function (value, getter, setter) {\n      var symbolCfg = this.mapValueToVisual(value);\n\n      if (zrUtil.isString(symbolCfg)) {\n        setter('symbol', symbolCfg);\n      } else if (isObject(symbolCfg)) {\n        for (var name in symbolCfg) {\n          if (symbolCfg.hasOwnProperty(name)) {\n            setter(name, symbolCfg[name]);\n          }\n        }\n      }\n    },\n    _doMap: {\n      linear: doMapToArray,\n      category: doMapCategory,\n      piecewise: function (normalized, value) {\n        var result = getSpecifiedVisual.call(this, value);\n\n        if (result == null) {\n          result = doMapToArray.call(this, normalized);\n        }\n\n        return result;\n      },\n      fixed: doMapFixed\n    }\n  },\n  symbolSize: {\n    applyVisual: makeApplyVisual('symbolSize'),\n    _doMap: makeDoMap([0, 1])\n  }\n};\n\nfunction preprocessForPiecewise(thisOption) {\n  var pieceList = thisOption.pieceList;\n  thisOption.hasSpecialVisual = false;\n  zrUtil.each(pieceList, function (piece, index) {\n    piece.originIndex = index; // piece.visual is \"result visual value\" but not\n    // a visual range, so it does not need to be normalized.\n\n    if (piece.visual != null) {\n      thisOption.hasSpecialVisual = true;\n    }\n  });\n}\n\nfunction preprocessForSpecifiedCategory(thisOption) {\n  // Hash categories.\n  var categories = thisOption.categories;\n  var visual = thisOption.visual;\n  var categoryMap = thisOption.categoryMap = {};\n  each(categories, function (cate, index) {\n    categoryMap[cate] = index;\n  }); // Process visual map input.\n\n  if (!zrUtil.isArray(visual)) {\n    var visualArr = [];\n\n    if (zrUtil.isObject(visual)) {\n      each(visual, function (v, cate) {\n        var index = categoryMap[cate];\n        visualArr[index != null ? index : CATEGORY_DEFAULT_VISUAL_INDEX] = v;\n      });\n    } else {\n      // Is primary type, represents default visual.\n      visualArr[CATEGORY_DEFAULT_VISUAL_INDEX] = visual;\n    }\n\n    visual = setVisualToOption(thisOption, visualArr);\n  } // Remove categories that has no visual,\n  // then we can mapping them to CATEGORY_DEFAULT_VISUAL_INDEX.\n\n\n  for (var i = categories.length - 1; i >= 0; i--) {\n    if (visual[i] == null) {\n      delete categoryMap[categories[i]];\n      categories.pop();\n    }\n  }\n}\n\nfunction normalizeVisualRange(thisOption, isCategory) {\n  var visual = thisOption.visual;\n  var visualArr = [];\n\n  if (zrUtil.isObject(visual)) {\n    each(visual, function (v) {\n      visualArr.push(v);\n    });\n  } else if (visual != null) {\n    visualArr.push(visual);\n  }\n\n  var doNotNeedPair = {\n    color: 1,\n    symbol: 1\n  };\n\n  if (!isCategory && visualArr.length === 1 && !doNotNeedPair.hasOwnProperty(thisOption.type)) {\n    // Do not care visualArr.length === 0, which is illegal.\n    visualArr[1] = visualArr[0];\n  }\n\n  setVisualToOption(thisOption, visualArr);\n}\n\nfunction makePartialColorVisualHandler(applyValue) {\n  return {\n    applyVisual: function (value, getter, setter) {\n      value = this.mapValueToVisual(value); // Must not be array value\n\n      setter('color', applyValue(getter('color'), value));\n    },\n    _doMap: makeDoMap([0, 1])\n  };\n}\n\nfunction doMapToArray(normalized) {\n  var visual = this.option.visual;\n  return visual[Math.round(linearMap(normalized, [0, 1], [0, visual.length - 1], true))] || {};\n}\n\nfunction makeApplyVisual(visualType) {\n  return function (value, getter, setter) {\n    setter(visualType, this.mapValueToVisual(value));\n  };\n}\n\nfunction doMapCategory(normalized) {\n  var visual = this.option.visual;\n  return visual[this.option.loop && normalized !== CATEGORY_DEFAULT_VISUAL_INDEX ? normalized % visual.length : normalized];\n}\n\nfunction doMapFixed() {\n  return this.option.visual[0];\n}\n\nfunction makeDoMap(sourceExtent) {\n  return {\n    linear: function (normalized) {\n      return linearMap(normalized, sourceExtent, this.option.visual, true);\n    },\n    category: doMapCategory,\n    piecewise: function (normalized, value) {\n      var result = getSpecifiedVisual.call(this, value);\n\n      if (result == null) {\n        result = linearMap(normalized, sourceExtent, this.option.visual, true);\n      }\n\n      return result;\n    },\n    fixed: doMapFixed\n  };\n}\n\nfunction getSpecifiedVisual(value) {\n  var thisOption = this.option;\n  var pieceList = thisOption.pieceList;\n\n  if (thisOption.hasSpecialVisual) {\n    var pieceIndex = VisualMapping.findPieceIndex(value, pieceList);\n    var piece = pieceList[pieceIndex];\n\n    if (piece && piece.visual) {\n      return piece.visual[this.type];\n    }\n  }\n}\n\nfunction setVisualToOption(thisOption, visualArr) {\n  thisOption.visual = visualArr;\n\n  if (thisOption.type === 'color') {\n    thisOption.parsedVisual = zrUtil.map(visualArr, function (item) {\n      return zrColor.parse(item);\n    });\n  }\n\n  return visualArr;\n}\n/**\n * Normalizers by mapping methods.\n */\n\n\nvar normalizers = {\n  linear: function (value) {\n    return linearMap(value, this.option.dataExtent, [0, 1], true);\n  },\n  piecewise: function (value) {\n    var pieceList = this.option.pieceList;\n    var pieceIndex = VisualMapping.findPieceIndex(value, pieceList, true);\n\n    if (pieceIndex != null) {\n      return linearMap(pieceIndex, [0, pieceList.length - 1], [0, 1], true);\n    }\n  },\n  category: function (value) {\n    var index = this.option.categories ? this.option.categoryMap[value] : value; // ordinal\n\n    return index == null ? CATEGORY_DEFAULT_VISUAL_INDEX : index;\n  },\n  fixed: zrUtil.noop\n};\n/**\n * List available visual types.\n *\n * @public\n * @return {Array.<string>}\n */\n\nVisualMapping.listVisualTypes = function () {\n  var visualTypes = [];\n  zrUtil.each(visualHandlers, function (handler, key) {\n    visualTypes.push(key);\n  });\n  return visualTypes;\n};\n/**\n * @public\n */\n\n\nVisualMapping.addVisualHandler = function (name, handler) {\n  visualHandlers[name] = handler;\n};\n/**\n * @public\n */\n\n\nVisualMapping.isValidType = function (visualType) {\n  return visualHandlers.hasOwnProperty(visualType);\n};\n/**\n * Convinent method.\n * Visual can be Object or Array or primary type.\n *\n * @public\n */\n\n\nVisualMapping.eachVisual = function (visual, callback, context) {\n  if (zrUtil.isObject(visual)) {\n    zrUtil.each(visual, callback, context);\n  } else {\n    callback.call(context, visual);\n  }\n};\n\nVisualMapping.mapVisual = function (visual, callback, context) {\n  var isPrimary;\n  var newVisual = zrUtil.isArray(visual) ? [] : zrUtil.isObject(visual) ? {} : (isPrimary = true, null);\n  VisualMapping.eachVisual(visual, function (v, key) {\n    var newVal = callback.call(context, v, key);\n    isPrimary ? newVisual = newVal : newVisual[key] = newVal;\n  });\n  return newVisual;\n};\n/**\n * @public\n * @param {Object} obj\n * @return {Object} new object containers visual values.\n *                 If no visuals, return null.\n */\n\n\nVisualMapping.retrieveVisuals = function (obj) {\n  var ret = {};\n  var hasVisual;\n  obj && each(visualHandlers, function (h, visualType) {\n    if (obj.hasOwnProperty(visualType)) {\n      ret[visualType] = obj[visualType];\n      hasVisual = true;\n    }\n  });\n  return hasVisual ? ret : null;\n};\n/**\n * Give order to visual types, considering colorSaturation, colorAlpha depends on color.\n *\n * @public\n * @param {(Object|Array)} visualTypes If Object, like: {color: ..., colorSaturation: ...}\n *                                     IF Array, like: ['color', 'symbol', 'colorSaturation']\n * @return {Array.<string>} Sorted visual types.\n */\n\n\nVisualMapping.prepareVisualTypes = function (visualTypes) {\n  if (isObject(visualTypes)) {\n    var types = [];\n    each(visualTypes, function (item, type) {\n      types.push(type);\n    });\n    visualTypes = types;\n  } else if (zrUtil.isArray(visualTypes)) {\n    visualTypes = visualTypes.slice();\n  } else {\n    return [];\n  }\n\n  visualTypes.sort(function (type1, type2) {\n    // color should be front of colorSaturation, colorAlpha, ...\n    // symbol and symbolSize do not matter.\n    return type2 === 'color' && type1 !== 'color' && type1.indexOf('color') === 0 ? 1 : -1;\n  });\n  return visualTypes;\n};\n/**\n * 'color', 'colorSaturation', 'colorAlpha', ... are depends on 'color'.\n * Other visuals are only depends on themself.\n *\n * @public\n * @param {string} visualType1\n * @param {string} visualType2\n * @return {boolean}\n */\n\n\nVisualMapping.dependsOn = function (visualType1, visualType2) {\n  return visualType2 === 'color' ? !!(visualType1 && visualType1.indexOf(visualType2) === 0) : visualType1 === visualType2;\n};\n/**\n * @param {number} value\n * @param {Array.<Object>} pieceList [{value: ..., interval: [min, max]}, ...]\n *                         Always from small to big.\n * @param {boolean} [findClosestWhenOutside=false]\n * @return {number} index\n */\n\n\nVisualMapping.findPieceIndex = function (value, pieceList, findClosestWhenOutside) {\n  var possibleI;\n  var abs = Infinity; // value has the higher priority.\n\n  for (var i = 0, len = pieceList.length; i < len; i++) {\n    var pieceValue = pieceList[i].value;\n\n    if (pieceValue != null) {\n      if (pieceValue === value // FIXME\n      // It is supposed to compare value according to value type of dimension,\n      // but currently value type can exactly be string or number.\n      // Compromise for numeric-like string (like '12'), especially\n      // in the case that visualMap.categories is ['22', '33'].\n      || typeof pieceValue === 'string' && pieceValue === value + '') {\n        return i;\n      }\n\n      findClosestWhenOutside && updatePossible(pieceValue, i);\n    }\n  }\n\n  for (var i = 0, len = pieceList.length; i < len; i++) {\n    var piece = pieceList[i];\n    var interval = piece.interval;\n    var close = piece.close;\n\n    if (interval) {\n      if (interval[0] === -Infinity) {\n        if (littleThan(close[1], value, interval[1])) {\n          return i;\n        }\n      } else if (interval[1] === Infinity) {\n        if (littleThan(close[0], interval[0], value)) {\n          return i;\n        }\n      } else if (littleThan(close[0], interval[0], value) && littleThan(close[1], value, interval[1])) {\n        return i;\n      }\n\n      findClosestWhenOutside && updatePossible(interval[0], i);\n      findClosestWhenOutside && updatePossible(interval[1], i);\n    }\n  }\n\n  if (findClosestWhenOutside) {\n    return value === Infinity ? pieceList.length - 1 : value === -Infinity ? 0 : possibleI;\n  }\n\n  function updatePossible(val, index) {\n    var newAbs = Math.abs(val - value);\n\n    if (newAbs < abs) {\n      abs = newAbs;\n      possibleI = index;\n    }\n  }\n};\n\nfunction littleThan(close, a, b) {\n  return close ? a <= b : a < b;\n}\n\nvar _default = VisualMapping;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar _config = require(\"../config\");\n\nvar __DEV__ = _config.__DEV__;\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar _clazz = require(\"../util/clazz\");\n\nvar enableClassCheck = _clazz.enableClassCheck;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n// id may be function name of Object, add a prefix to avoid this problem.\nfunction generateNodeKey(id) {\n  return '_EC_' + id;\n}\n/**\n * @alias module:echarts/data/Graph\n * @constructor\n * @param {boolean} directed\n */\n\n\nvar Graph = function (directed) {\n  /**\n   * \n   * @type {boolean}\n   * @private\n   */\n  this._directed = directed || false;\n  /**\n   * @type {Array.<module:echarts/data/Graph.Node>}\n   * @readOnly\n   */\n\n  this.nodes = [];\n  /**\n   * @type {Array.<module:echarts/data/Graph.Edge>}\n   * @readOnly\n   */\n\n  this.edges = [];\n  /**\n   * @type {Object.<string, module:echarts/data/Graph.Node>}\n   * @private\n   */\n\n  this._nodesMap = {};\n  /**\n   * @type {Object.<string, module:echarts/data/Graph.Edge>}\n   * @private\n   */\n\n  this._edgesMap = {};\n  /**\n   * @type {module:echarts/data/List}\n   * @readOnly\n   */\n\n  this.data;\n  /**\n   * @type {module:echarts/data/List}\n   * @readOnly\n   */\n\n  this.edgeData;\n};\n\nvar graphProto = Graph.prototype;\n/**\n * @type {string}\n */\n\ngraphProto.type = 'graph';\n/**\n * If is directed graph\n * @return {boolean}\n */\n\ngraphProto.isDirected = function () {\n  return this._directed;\n};\n/**\n * Add a new node\n * @param {string} id\n * @param {number} [dataIndex]\n */\n\n\ngraphProto.addNode = function (id, dataIndex) {\n  id = id == null ? '' + dataIndex : '' + id;\n  var nodesMap = this._nodesMap;\n\n  if (nodesMap[generateNodeKey(id)]) {\n    return;\n  }\n\n  var node = new Node(id, dataIndex);\n  node.hostGraph = this;\n  this.nodes.push(node);\n  nodesMap[generateNodeKey(id)] = node;\n  return node;\n};\n/**\n * Get node by data index\n * @param  {number} dataIndex\n * @return {module:echarts/data/Graph~Node}\n */\n\n\ngraphProto.getNodeByIndex = function (dataIndex) {\n  var rawIdx = this.data.getRawIndex(dataIndex);\n  return this.nodes[rawIdx];\n};\n/**\n * Get node by id\n * @param  {string} id\n * @return {module:echarts/data/Graph.Node}\n */\n\n\ngraphProto.getNodeById = function (id) {\n  return this._nodesMap[generateNodeKey(id)];\n};\n/**\n * Add a new edge\n * @param {number|string|module:echarts/data/Graph.Node} n1\n * @param {number|string|module:echarts/data/Graph.Node} n2\n * @param {number} [dataIndex=-1]\n * @return {module:echarts/data/Graph.Edge}\n */\n\n\ngraphProto.addEdge = function (n1, n2, dataIndex) {\n  var nodesMap = this._nodesMap;\n  var edgesMap = this._edgesMap; // PNEDING\n\n  if (typeof n1 === 'number') {\n    n1 = this.nodes[n1];\n  }\n\n  if (typeof n2 === 'number') {\n    n2 = this.nodes[n2];\n  }\n\n  if (!Node.isInstance(n1)) {\n    n1 = nodesMap[generateNodeKey(n1)];\n  }\n\n  if (!Node.isInstance(n2)) {\n    n2 = nodesMap[generateNodeKey(n2)];\n  }\n\n  if (!n1 || !n2) {\n    return;\n  }\n\n  var key = n1.id + '-' + n2.id; // PENDING\n\n  if (edgesMap[key]) {\n    return;\n  }\n\n  var edge = new Edge(n1, n2, dataIndex);\n  edge.hostGraph = this;\n\n  if (this._directed) {\n    n1.outEdges.push(edge);\n    n2.inEdges.push(edge);\n  }\n\n  n1.edges.push(edge);\n\n  if (n1 !== n2) {\n    n2.edges.push(edge);\n  }\n\n  this.edges.push(edge);\n  edgesMap[key] = edge;\n  return edge;\n};\n/**\n * Get edge by data index\n * @param  {number} dataIndex\n * @return {module:echarts/data/Graph~Node}\n */\n\n\ngraphProto.getEdgeByIndex = function (dataIndex) {\n  var rawIdx = this.edgeData.getRawIndex(dataIndex);\n  return this.edges[rawIdx];\n};\n/**\n * Get edge by two linked nodes\n * @param  {module:echarts/data/Graph.Node|string} n1\n * @param  {module:echarts/data/Graph.Node|string} n2\n * @return {module:echarts/data/Graph.Edge}\n */\n\n\ngraphProto.getEdge = function (n1, n2) {\n  if (Node.isInstance(n1)) {\n    n1 = n1.id;\n  }\n\n  if (Node.isInstance(n2)) {\n    n2 = n2.id;\n  }\n\n  var edgesMap = this._edgesMap;\n\n  if (this._directed) {\n    return edgesMap[n1 + '-' + n2];\n  } else {\n    return edgesMap[n1 + '-' + n2] || edgesMap[n2 + '-' + n1];\n  }\n};\n/**\n * Iterate all nodes\n * @param  {Function} cb\n * @param  {*} [context]\n */\n\n\ngraphProto.eachNode = function (cb, context) {\n  var nodes = this.nodes;\n  var len = nodes.length;\n\n  for (var i = 0; i < len; i++) {\n    if (nodes[i].dataIndex >= 0) {\n      cb.call(context, nodes[i], i);\n    }\n  }\n};\n/**\n * Iterate all edges\n * @param  {Function} cb\n * @param  {*} [context]\n */\n\n\ngraphProto.eachEdge = function (cb, context) {\n  var edges = this.edges;\n  var len = edges.length;\n\n  for (var i = 0; i < len; i++) {\n    if (edges[i].dataIndex >= 0 && edges[i].node1.dataIndex >= 0 && edges[i].node2.dataIndex >= 0) {\n      cb.call(context, edges[i], i);\n    }\n  }\n};\n/**\n * Breadth first traverse\n * @param {Function} cb\n * @param {module:echarts/data/Graph.Node} startNode\n * @param {string} [direction='none'] 'none'|'in'|'out'\n * @param {*} [context]\n */\n\n\ngraphProto.breadthFirstTraverse = function (cb, startNode, direction, context) {\n  if (!Node.isInstance(startNode)) {\n    startNode = this._nodesMap[generateNodeKey(startNode)];\n  }\n\n  if (!startNode) {\n    return;\n  }\n\n  var edgeType = direction === 'out' ? 'outEdges' : direction === 'in' ? 'inEdges' : 'edges';\n\n  for (var i = 0; i < this.nodes.length; i++) {\n    this.nodes[i].__visited = false;\n  }\n\n  if (cb.call(context, startNode, null)) {\n    return;\n  }\n\n  var queue = [startNode];\n\n  while (queue.length) {\n    var currentNode = queue.shift();\n    var edges = currentNode[edgeType];\n\n    for (var i = 0; i < edges.length; i++) {\n      var e = edges[i];\n      var otherNode = e.node1 === currentNode ? e.node2 : e.node1;\n\n      if (!otherNode.__visited) {\n        if (cb.call(context, otherNode, currentNode)) {\n          // Stop traversing\n          return;\n        }\n\n        queue.push(otherNode);\n        otherNode.__visited = true;\n      }\n    }\n  }\n}; // TODO\n// graphProto.depthFirstTraverse = function (\n//     cb, startNode, direction, context\n// ) {\n// };\n// Filter update\n\n\ngraphProto.update = function () {\n  var data = this.data;\n  var edgeData = this.edgeData;\n  var nodes = this.nodes;\n  var edges = this.edges;\n\n  for (var i = 0, len = nodes.length; i < len; i++) {\n    nodes[i].dataIndex = -1;\n  }\n\n  for (var i = 0, len = data.count(); i < len; i++) {\n    nodes[data.getRawIndex(i)].dataIndex = i;\n  }\n\n  edgeData.filterSelf(function (idx) {\n    var edge = edges[edgeData.getRawIndex(idx)];\n    return edge.node1.dataIndex >= 0 && edge.node2.dataIndex >= 0;\n  }); // Update edge\n\n  for (var i = 0, len = edges.length; i < len; i++) {\n    edges[i].dataIndex = -1;\n  }\n\n  for (var i = 0, len = edgeData.count(); i < len; i++) {\n    edges[edgeData.getRawIndex(i)].dataIndex = i;\n  }\n};\n/**\n * @return {module:echarts/data/Graph}\n */\n\n\ngraphProto.clone = function () {\n  var graph = new Graph(this._directed);\n  var nodes = this.nodes;\n  var edges = this.edges;\n\n  for (var i = 0; i < nodes.length; i++) {\n    graph.addNode(nodes[i].id, nodes[i].dataIndex);\n  }\n\n  for (var i = 0; i < edges.length; i++) {\n    var e = edges[i];\n    graph.addEdge(e.node1.id, e.node2.id, e.dataIndex);\n  }\n\n  return graph;\n};\n/**\n * @alias module:echarts/data/Graph.Node\n */\n\n\nfunction Node(id, dataIndex) {\n  /**\n  * @type {string}\n  */\n  this.id = id == null ? '' : id;\n  /**\n  * @type {Array.<module:echarts/data/Graph.Edge>}\n  */\n\n  this.inEdges = [];\n  /**\n  * @type {Array.<module:echarts/data/Graph.Edge>}\n  */\n\n  this.outEdges = [];\n  /**\n  * @type {Array.<module:echarts/data/Graph.Edge>}\n  */\n\n  this.edges = [];\n  /**\n   * @type {module:echarts/data/Graph}\n   */\n\n  this.hostGraph;\n  /**\n   * @type {number}\n   */\n\n  this.dataIndex = dataIndex == null ? -1 : dataIndex;\n}\n\nNode.prototype = {\n  constructor: Node,\n\n  /**\n   * @return {number}\n   */\n  degree: function () {\n    return this.edges.length;\n  },\n\n  /**\n   * @return {number}\n   */\n  inDegree: function () {\n    return this.inEdges.length;\n  },\n\n  /**\n  * @return {number}\n  */\n  outDegree: function () {\n    return this.outEdges.length;\n  },\n\n  /**\n   * @param {string} [path]\n   * @return {module:echarts/model/Model}\n   */\n  getModel: function (path) {\n    if (this.dataIndex < 0) {\n      return;\n    }\n\n    var graph = this.hostGraph;\n    var itemModel = graph.data.getItemModel(this.dataIndex);\n    return itemModel.getModel(path);\n  }\n};\n/**\n * \n * @alias module:echarts/data/Graph.Edge\n * @param {module:echarts/data/Graph.Node} n1\n * @param {module:echarts/data/Graph.Node} n2\n * @param {number} [dataIndex=-1]\n */\n\nfunction Edge(n1, n2, dataIndex) {\n  /**\n   * 1\n   * @type {module:echarts/data/Graph.Node}\n   */\n  this.node1 = n1;\n  /**\n   * 2\n   * @type {module:echarts/data/Graph.Node}\n   */\n\n  this.node2 = n2;\n  this.dataIndex = dataIndex == null ? -1 : dataIndex;\n}\n/**\n * @param {string} [path]\n * @return {module:echarts/model/Model}\n */\n\n\nEdge.prototype.getModel = function (path) {\n  if (this.dataIndex < 0) {\n    return;\n  }\n\n  var graph = this.hostGraph;\n  var itemModel = graph.edgeData.getItemModel(this.dataIndex);\n  return itemModel.getModel(path);\n};\n\nvar createGraphDataProxyMixin = function (hostName, dataName) {\n  return {\n    /**\n     * @param {string=} [dimension='value'] Default 'value'. can be 'a', 'b', 'c', 'd', 'e'.\n     * @return {number}\n     */\n    getValue: function (dimension) {\n      var data = this[hostName][dataName];\n      return data.get(data.getDimension(dimension || 'value'), this.dataIndex);\n    },\n\n    /**\n     * @param {Object|string} key\n     * @param {*} [value]\n     */\n    setVisual: function (key, value) {\n      this.dataIndex >= 0 && this[hostName][dataName].setItemVisual(this.dataIndex, key, value);\n    },\n\n    /**\n     * @param {string} key\n     * @return {boolean}\n     */\n    getVisual: function (key, ignoreParent) {\n      return this[hostName][dataName].getItemVisual(this.dataIndex, key, ignoreParent);\n    },\n\n    /**\n     * @param {Object} layout\n     * @return {boolean} [merge=false]\n     */\n    setLayout: function (layout, merge) {\n      this.dataIndex >= 0 && this[hostName][dataName].setItemLayout(this.dataIndex, layout, merge);\n    },\n\n    /**\n     * @return {Object}\n     */\n    getLayout: function () {\n      return this[hostName][dataName].getItemLayout(this.dataIndex);\n    },\n\n    /**\n     * @return {module:zrender/Element}\n     */\n    getGraphicEl: function () {\n      return this[hostName][dataName].getItemGraphicEl(this.dataIndex);\n    },\n\n    /**\n     * @return {number}\n     */\n    getRawIndex: function () {\n      return this[hostName][dataName].getRawIndex(this.dataIndex);\n    }\n  };\n};\n\nzrUtil.mixin(Node, createGraphDataProxyMixin('hostGraph', 'data'));\nzrUtil.mixin(Edge, createGraphDataProxyMixin('hostGraph', 'edgeData'));\nGraph.Node = Node;\nGraph.Edge = Edge;\nenableClassCheck(Node);\nenableClassCheck(Edge);\nvar _default = Graph;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar layout = require(\"../../util/layout\");\n\nvar zrUtil = require(\"zrender/lib/core/util\");\n\nvar _model = require(\"../../util/model\");\n\nvar groupData = _model.groupData;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nfunction _default(ecModel, api, payload) {\n  ecModel.eachSeriesByType('sankey', function (seriesModel) {\n    var nodeWidth = seriesModel.get('nodeWidth');\n    var nodeGap = seriesModel.get('nodeGap');\n    var layoutInfo = getViewRect(seriesModel, api);\n    seriesModel.layoutInfo = layoutInfo;\n    var width = layoutInfo.width;\n    var height = layoutInfo.height;\n    var graph = seriesModel.getGraph();\n    var nodes = graph.nodes;\n    var edges = graph.edges;\n    computeNodeValues(nodes);\n    var filteredNodes = zrUtil.filter(nodes, function (node) {\n      return node.getLayout().value === 0;\n    });\n    var iterations = filteredNodes.length !== 0 ? 0 : seriesModel.get('layoutIterations');\n    var orient = seriesModel.get('orient');\n    var nodeAlign = seriesModel.get('nodeAlign');\n    layoutSankey(nodes, edges, nodeWidth, nodeGap, width, height, iterations, orient, nodeAlign);\n  });\n}\n/**\n * Get the layout position of the whole view\n *\n * @param {module:echarts/model/Series} seriesModel  the model object of sankey series\n * @param {module:echarts/ExtensionAPI} api  provide the API list that the developer can call\n * @return {module:zrender/core/BoundingRect}  size of rect to draw the sankey view\n */\n\n\nfunction getViewRect(seriesModel, api) {\n  return layout.getLayoutRect(seriesModel.getBoxLayoutParams(), {\n    width: api.getWidth(),\n    height: api.getHeight()\n  });\n}\n\nfunction layoutSankey(nodes, edges, nodeWidth, nodeGap, width, height, iterations, orient, nodeAlign) {\n  computeNodeBreadths(nodes, edges, nodeWidth, width, height, orient, nodeAlign);\n  computeNodeDepths(nodes, edges, height, width, nodeGap, iterations, orient);\n  computeEdgeDepths(nodes, orient);\n}\n/**\n * Compute the value of each node by summing the associated edge's value\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n */\n\n\nfunction computeNodeValues(nodes) {\n  zrUtil.each(nodes, function (node) {\n    var value1 = sum(node.outEdges, getEdgeValue);\n    var value2 = sum(node.inEdges, getEdgeValue);\n    var nodeRawValue = node.getValue() || 0;\n    var value = Math.max(value1, value2, nodeRawValue);\n    node.setLayout({\n      value: value\n    }, true);\n  });\n}\n/**\n * Compute the x-position for each node.\n *\n * Here we use Kahn algorithm to detect cycle when we traverse\n * the node to computer the initial x position.\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param  {number} nodeWidth  the dx of the node\n * @param  {number} width  the whole width of the area to draw the view\n */\n\n\nfunction computeNodeBreadths(nodes, edges, nodeWidth, width, height, orient, nodeAlign) {\n  // Used to mark whether the edge is deleted. if it is deleted,\n  // the value is 0, otherwise it is 1.\n  var remainEdges = []; // Storage each node's indegree.\n\n  var indegreeArr = []; //Used to storage the node with indegree is equal to 0.\n\n  var zeroIndegrees = [];\n  var nextTargetNode = [];\n  var x = 0;\n  var kx = 0;\n\n  for (var i = 0; i < edges.length; i++) {\n    remainEdges[i] = 1;\n  }\n\n  for (i = 0; i < nodes.length; i++) {\n    indegreeArr[i] = nodes[i].inEdges.length;\n\n    if (indegreeArr[i] === 0) {\n      zeroIndegrees.push(nodes[i]);\n    }\n  }\n\n  var maxNodeDepth = -1; // Traversing nodes using topological sorting to calculate the\n  // horizontal(if orient === 'horizontal') or vertical(if orient === 'vertical')\n  // position of the nodes.\n\n  while (zeroIndegrees.length) {\n    for (var idx = 0; idx < zeroIndegrees.length; idx++) {\n      var node = zeroIndegrees[idx];\n      var item = node.hostGraph.data.getRawDataItem(node.dataIndex);\n      var isItemDepth = item.depth != null && item.depth >= 0;\n\n      if (isItemDepth && item.depth > maxNodeDepth) {\n        maxNodeDepth = item.depth;\n      }\n\n      node.setLayout({\n        depth: isItemDepth ? item.depth : x\n      }, true);\n      orient === 'vertical' ? node.setLayout({\n        dy: nodeWidth\n      }, true) : node.setLayout({\n        dx: nodeWidth\n      }, true);\n\n      for (var edgeIdx = 0; edgeIdx < node.outEdges.length; edgeIdx++) {\n        var edge = node.outEdges[edgeIdx];\n        var indexEdge = edges.indexOf(edge);\n        remainEdges[indexEdge] = 0;\n        var targetNode = edge.node2;\n        var nodeIndex = nodes.indexOf(targetNode);\n\n        if (--indegreeArr[nodeIndex] === 0 && nextTargetNode.indexOf(targetNode) < 0) {\n          nextTargetNode.push(targetNode);\n        }\n      }\n    }\n\n    ++x;\n    zeroIndegrees = nextTargetNode;\n    nextTargetNode = [];\n  }\n\n  for (i = 0; i < remainEdges.length; i++) {\n    if (remainEdges[i] === 1) {\n      throw new Error('Sankey is a DAG, the original data has cycle!');\n    }\n  }\n\n  var maxDepth = maxNodeDepth > x - 1 ? maxNodeDepth : x - 1;\n\n  if (nodeAlign && nodeAlign !== 'left') {\n    adjustNodeWithNodeAlign(nodes, nodeAlign, orient, maxDepth);\n  }\n\n  var kx = orient === 'vertical' ? (height - nodeWidth) / maxDepth : (width - nodeWidth) / maxDepth;\n  scaleNodeBreadths(nodes, kx, orient);\n}\n\nfunction isNodeDepth(node) {\n  var item = node.hostGraph.data.getRawDataItem(node.dataIndex);\n  return item.depth != null && item.depth >= 0;\n}\n\nfunction adjustNodeWithNodeAlign(nodes, nodeAlign, orient, maxDepth) {\n  if (nodeAlign === 'right') {\n    var nextSourceNode = [];\n    var remainNodes = nodes;\n    var nodeHeight = 0;\n\n    while (remainNodes.length) {\n      for (var i = 0; i < remainNodes.length; i++) {\n        var node = remainNodes[i];\n        node.setLayout({\n          skNodeHeight: nodeHeight\n        }, true);\n\n        for (var j = 0; j < node.inEdges.length; j++) {\n          var edge = node.inEdges[j];\n\n          if (nextSourceNode.indexOf(edge.node1) < 0) {\n            nextSourceNode.push(edge.node1);\n          }\n        }\n      }\n\n      remainNodes = nextSourceNode;\n      nextSourceNode = [];\n      ++nodeHeight;\n    }\n\n    zrUtil.each(nodes, function (node) {\n      if (!isNodeDepth(node)) {\n        node.setLayout({\n          depth: Math.max(0, maxDepth - node.getLayout().skNodeHeight)\n        }, true);\n      }\n    });\n  } else if (nodeAlign === 'justify') {\n    moveSinksRight(nodes, maxDepth);\n  }\n}\n/**\n * All the node without outEgdes are assigned maximum x-position and\n *     be aligned in the last column.\n *\n * @param {module:echarts/data/Graph~Node} nodes.  node of sankey view.\n * @param {number} maxDepth.  use to assign to node without outEdges as x-position.\n */\n\n\nfunction moveSinksRight(nodes, maxDepth) {\n  zrUtil.each(nodes, function (node) {\n    if (!isNodeDepth(node) && !node.outEdges.length) {\n      node.setLayout({\n        depth: maxDepth\n      }, true);\n    }\n  });\n}\n/**\n * Scale node x-position to the width\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param {number} kx   multiple used to scale nodes\n */\n\n\nfunction scaleNodeBreadths(nodes, kx, orient) {\n  zrUtil.each(nodes, function (node) {\n    var nodeDepth = node.getLayout().depth * kx;\n    orient === 'vertical' ? node.setLayout({\n      y: nodeDepth\n    }, true) : node.setLayout({\n      x: nodeDepth\n    }, true);\n  });\n}\n/**\n * Using Gauss-Seidel iterations method to compute the node depth(y-position)\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param {module:echarts/data/Graph~Edge} edges  edge of sankey view\n * @param {number} height  the whole height of the area to draw the view\n * @param {number} nodeGap  the vertical distance between two nodes\n *     in the same column.\n * @param {number} iterations  the number of iterations for the algorithm\n */\n\n\nfunction computeNodeDepths(nodes, edges, height, width, nodeGap, iterations, orient) {\n  var nodesByBreadth = prepareNodesByBreadth(nodes, orient);\n  initializeNodeDepth(nodesByBreadth, edges, height, width, nodeGap, orient);\n  resolveCollisions(nodesByBreadth, nodeGap, height, width, orient);\n\n  for (var alpha = 1; iterations > 0; iterations--) {\n    // 0.99 is a experience parameter, ensure that each iterations of\n    // changes as small as possible.\n    alpha *= 0.99;\n    relaxRightToLeft(nodesByBreadth, alpha, orient);\n    resolveCollisions(nodesByBreadth, nodeGap, height, width, orient);\n    relaxLeftToRight(nodesByBreadth, alpha, orient);\n    resolveCollisions(nodesByBreadth, nodeGap, height, width, orient);\n  }\n}\n\nfunction prepareNodesByBreadth(nodes, orient) {\n  var nodesByBreadth = [];\n  var keyAttr = orient === 'vertical' ? 'y' : 'x';\n  var groupResult = groupData(nodes, function (node) {\n    return node.getLayout()[keyAttr];\n  });\n  groupResult.keys.sort(function (a, b) {\n    return a - b;\n  });\n  zrUtil.each(groupResult.keys, function (key) {\n    nodesByBreadth.push(groupResult.buckets.get(key));\n  });\n  return nodesByBreadth;\n}\n/**\n * Compute the original y-position for each node\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n * @param {Array.<Array.<module:echarts/data/Graph~Node>>} nodesByBreadth\n *     group by the array of all sankey nodes based on the nodes x-position.\n * @param {module:echarts/data/Graph~Edge} edges  edge of sankey view\n * @param {number} height  the whole height of the area to draw the view\n * @param {number} nodeGap  the vertical distance between two nodes\n */\n\n\nfunction initializeNodeDepth(nodesByBreadth, edges, height, width, nodeGap, orient) {\n  var minKy = Infinity;\n  zrUtil.each(nodesByBreadth, function (nodes) {\n    var n = nodes.length;\n    var sum = 0;\n    zrUtil.each(nodes, function (node) {\n      sum += node.getLayout().value;\n    });\n    var ky = orient === 'vertical' ? (width - (n - 1) * nodeGap) / sum : (height - (n - 1) * nodeGap) / sum;\n\n    if (ky < minKy) {\n      minKy = ky;\n    }\n  });\n  zrUtil.each(nodesByBreadth, function (nodes) {\n    zrUtil.each(nodes, function (node, i) {\n      var nodeDy = node.getLayout().value * minKy;\n\n      if (orient === 'vertical') {\n        node.setLayout({\n          x: i\n        }, true);\n        node.setLayout({\n          dx: nodeDy\n        }, true);\n      } else {\n        node.setLayout({\n          y: i\n        }, true);\n        node.setLayout({\n          dy: nodeDy\n        }, true);\n      }\n    });\n  });\n  zrUtil.each(edges, function (edge) {\n    var edgeDy = +edge.getValue() * minKy;\n    edge.setLayout({\n      dy: edgeDy\n    }, true);\n  });\n}\n/**\n * Resolve the collision of initialized depth (y-position)\n *\n * @param {Array.<Array.<module:echarts/data/Graph~Node>>} nodesByBreadth\n *     group by the array of all sankey nodes based on the nodes x-position.\n * @param {number} nodeGap  the vertical distance between two nodes\n * @param {number} height  the whole height of the area to draw the view\n */\n\n\nfunction resolveCollisions(nodesByBreadth, nodeGap, height, width, orient) {\n  var keyAttr = orient === 'vertical' ? 'x' : 'y';\n  zrUtil.each(nodesByBreadth, function (nodes) {\n    nodes.sort(function (a, b) {\n      return a.getLayout()[keyAttr] - b.getLayout()[keyAttr];\n    });\n    var nodeX;\n    var node;\n    var dy;\n    var y0 = 0;\n    var n = nodes.length;\n    var nodeDyAttr = orient === 'vertical' ? 'dx' : 'dy';\n\n    for (var i = 0; i < n; i++) {\n      node = nodes[i];\n      dy = y0 - node.getLayout()[keyAttr];\n\n      if (dy > 0) {\n        nodeX = node.getLayout()[keyAttr] + dy;\n        orient === 'vertical' ? node.setLayout({\n          x: nodeX\n        }, true) : node.setLayout({\n          y: nodeX\n        }, true);\n      }\n\n      y0 = node.getLayout()[keyAttr] + node.getLayout()[nodeDyAttr] + nodeGap;\n    }\n\n    var viewWidth = orient === 'vertical' ? width : height; // If the bottommost node goes outside the bounds, push it back up\n\n    dy = y0 - nodeGap - viewWidth;\n\n    if (dy > 0) {\n      nodeX = node.getLayout()[keyAttr] - dy;\n      orient === 'vertical' ? node.setLayout({\n        x: nodeX\n      }, true) : node.setLayout({\n        y: nodeX\n      }, true);\n      y0 = nodeX;\n\n      for (i = n - 2; i >= 0; --i) {\n        node = nodes[i];\n        dy = node.getLayout()[keyAttr] + node.getLayout()[nodeDyAttr] + nodeGap - y0;\n\n        if (dy > 0) {\n          nodeX = node.getLayout()[keyAttr] - dy;\n          orient === 'vertical' ? node.setLayout({\n            x: nodeX\n          }, true) : node.setLayout({\n            y: nodeX\n          }, true);\n        }\n\n        y0 = node.getLayout()[keyAttr];\n      }\n    }\n  });\n}\n/**\n * Change the y-position of the nodes, except most the right side nodes\n *\n * @param {Array.<Array.<module:echarts/data/Graph~Node>>} nodesByBreadth\n *     group by the array of all sankey nodes based on the node x-position.\n * @param {number} alpha  parameter used to adjust the nodes y-position\n */\n\n\nfunction relaxRightToLeft(nodesByBreadth, alpha, orient) {\n  zrUtil.each(nodesByBreadth.slice().reverse(), function (nodes) {\n    zrUtil.each(nodes, function (node) {\n      if (node.outEdges.length) {\n        var y = sum(node.outEdges, weightedTarget, orient) / sum(node.outEdges, getEdgeValue, orient);\n\n        if (isNaN(y)) {\n          var len = node.outEdges.length;\n          y = len ? sum(node.outEdges, centerTarget, orient) / len : 0;\n        }\n\n        if (orient === 'vertical') {\n          var nodeX = node.getLayout().x + (y - center(node, orient)) * alpha;\n          node.setLayout({\n            x: nodeX\n          }, true);\n        } else {\n          var nodeY = node.getLayout().y + (y - center(node, orient)) * alpha;\n          node.setLayout({\n            y: nodeY\n          }, true);\n        }\n      }\n    });\n  });\n}\n\nfunction weightedTarget(edge, orient) {\n  return center(edge.node2, orient) * edge.getValue();\n}\n\nfunction centerTarget(edge, orient) {\n  return center(edge.node2, orient);\n}\n\nfunction weightedSource(edge, orient) {\n  return center(edge.node1, orient) * edge.getValue();\n}\n\nfunction centerSource(edge, orient) {\n  return center(edge.node1, orient);\n}\n\nfunction center(node, orient) {\n  return orient === 'vertical' ? node.getLayout().x + node.getLayout().dx / 2 : node.getLayout().y + node.getLayout().dy / 2;\n}\n\nfunction getEdgeValue(edge) {\n  return edge.getValue();\n}\n\nfunction sum(array, cb, orient) {\n  var sum = 0;\n  var len = array.length;\n  var i = -1;\n\n  while (++i < len) {\n    var value = +cb.call(array, array[i], orient);\n\n    if (!isNaN(value)) {\n      sum += value;\n    }\n  }\n\n  return sum;\n}\n/**\n * Change the y-position of the nodes, except most the left side nodes\n *\n * @param {Array.<Array.<module:echarts/data/Graph~Node>>} nodesByBreadth\n *     group by the array of all sankey nodes based on the node x-position.\n * @param {number} alpha  parameter used to adjust the nodes y-position\n */\n\n\nfunction relaxLeftToRight(nodesByBreadth, alpha, orient) {\n  zrUtil.each(nodesByBreadth, function (nodes) {\n    zrUtil.each(nodes, function (node) {\n      if (node.inEdges.length) {\n        var y = sum(node.inEdges, weightedSource, orient) / sum(node.inEdges, getEdgeValue, orient);\n\n        if (isNaN(y)) {\n          var len = node.inEdges.length;\n          y = len ? sum(node.inEdges, centerSource, orient) / len : 0;\n        }\n\n        if (orient === 'vertical') {\n          var nodeX = node.getLayout().x + (y - center(node, orient)) * alpha;\n          node.setLayout({\n            x: nodeX\n          }, true);\n        } else {\n          var nodeY = node.getLayout().y + (y - center(node, orient)) * alpha;\n          node.setLayout({\n            y: nodeY\n          }, true);\n        }\n      }\n    });\n  });\n}\n/**\n * Compute the depth(y-position) of each edge\n *\n * @param {module:echarts/data/Graph~Node} nodes  node of sankey view\n */\n\n\nfunction computeEdgeDepths(nodes, orient) {\n  var keyAttr = orient === 'vertical' ? 'x' : 'y';\n  zrUtil.each(nodes, function (node) {\n    node.outEdges.sort(function (a, b) {\n      return a.node2.getLayout()[keyAttr] - b.node2.getLayout()[keyAttr];\n    });\n    node.inEdges.sort(function (a, b) {\n      return a.node1.getLayout()[keyAttr] - b.node1.getLayout()[keyAttr];\n    });\n  });\n  zrUtil.each(nodes, function (node) {\n    var sy = 0;\n    var ty = 0;\n    zrUtil.each(node.outEdges, function (edge) {\n      edge.setLayout({\n        sy: sy\n      }, true);\n      sy += edge.getLayout().dy;\n    });\n    zrUtil.each(node.inEdges, function (edge) {\n      edge.setLayout({\n        ty: ty\n      }, true);\n      ty += edge.getLayout().dy;\n    });\n  });\n}\n\nmodule.exports = _default;","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sankey.vue?vue&type=style&index=0&id=e0578438&lang=less&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./sankey.vue?vue&type=style&index=0&id=e0578438&lang=less&scoped=true&\"","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\nrequire(\"../helper/focusNodeAdjacencyAction\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\necharts.registerAction({\n  type: 'dragNode',\n  event: 'dragnode',\n  // here can only use 'update' now, other value is not support in echarts.\n  update: 'update'\n}, function (payload, ecModel) {\n  ecModel.eachComponent({\n    mainType: 'series',\n    subType: 'sankey',\n    query: payload\n  }, function (seriesModel) {\n    seriesModel.setNodePosition(payload.dataIndex, [payload.localX, payload.localY]);\n  });\n});","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar SeriesModel = require(\"../../model/Series\");\n\nvar createGraphFromNodeEdge = require(\"../helper/createGraphFromNodeEdge\");\n\nvar _format = require(\"../../util/format\");\n\nvar encodeHTML = _format.encodeHTML;\n\nvar Model = require(\"../../model/Model\");\n\nvar _config = require(\"../../config\");\n\nvar __DEV__ = _config.__DEV__;\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\nvar SankeySeries = SeriesModel.extend({\n  type: 'series.sankey',\n  layoutInfo: null,\n  levelModels: null,\n\n  /**\n   * Init a graph data structure from data in option series\n   *\n   * @param  {Object} option  the object used to config echarts view\n   * @return {module:echarts/data/List} storage initial data\n   */\n  getInitialData: function (option, ecModel) {\n    var links = option.edges || option.links;\n    var nodes = option.data || option.nodes;\n    var levels = option.levels;\n    var levelModels = this.levelModels = {};\n\n    for (var i = 0; i < levels.length; i++) {\n      if (levels[i].depth != null && levels[i].depth >= 0) {\n        levelModels[levels[i].depth] = new Model(levels[i], this, ecModel);\n      } else {}\n    }\n\n    if (nodes && links) {\n      var graph = createGraphFromNodeEdge(nodes, links, this, true, beforeLink);\n      return graph.data;\n    }\n\n    function beforeLink(nodeData, edgeData) {\n      nodeData.wrapMethod('getItemModel', function (model, idx) {\n        model.customizeGetParent(function (path) {\n          var parentModel = this.parentModel;\n          var nodeDepth = parentModel.getData().getItemLayout(idx).depth;\n          var levelModel = parentModel.levelModels[nodeDepth];\n          return levelModel || this.parentModel;\n        });\n        return model;\n      });\n      edgeData.wrapMethod('getItemModel', function (model, idx) {\n        model.customizeGetParent(function (path) {\n          var parentModel = this.parentModel;\n          var edge = parentModel.getGraph().getEdgeByIndex(idx);\n          var depth = edge.node1.getLayout().depth;\n          var levelModel = parentModel.levelModels[depth];\n          return levelModel || this.parentModel;\n        });\n        return model;\n      });\n    }\n  },\n  setNodePosition: function (dataIndex, localPosition) {\n    var dataItem = this.option.data[dataIndex];\n    dataItem.localX = localPosition[0];\n    dataItem.localY = localPosition[1];\n  },\n\n  /**\n   * Return the graphic data structure\n   *\n   * @return {module:echarts/data/Graph} graphic data structure\n   */\n  getGraph: function () {\n    return this.getData().graph;\n  },\n\n  /**\n   * Get edge data of graphic data structure\n   *\n   * @return {module:echarts/data/List} data structure of list\n   */\n  getEdgeData: function () {\n    return this.getGraph().edgeData;\n  },\n\n  /**\n   * @override\n   */\n  formatTooltip: function (dataIndex, multipleSeries, dataType) {\n    // dataType === 'node' or empty do not show tooltip by default\n    if (dataType === 'edge') {\n      var params = this.getDataParams(dataIndex, dataType);\n      var rawDataOpt = params.data;\n      var html = rawDataOpt.source + ' -- ' + rawDataOpt.target;\n\n      if (params.value) {\n        html += ' : ' + params.value;\n      }\n\n      return encodeHTML(html);\n    } else if (dataType === 'node') {\n      var node = this.getGraph().getNodeByIndex(dataIndex);\n      var value = node.getLayout().value;\n      var name = this.getDataParams(dataIndex, dataType).data.name;\n\n      if (value) {\n        var html = name + ' : ' + value;\n      }\n\n      return encodeHTML(html);\n    }\n\n    return SankeySeries.superCall(this, 'formatTooltip', dataIndex, multipleSeries);\n  },\n  optionUpdated: function () {\n    var option = this.option;\n\n    if (option.focusNodeAdjacency === true) {\n      option.focusNodeAdjacency = 'allEdges';\n    }\n  },\n  // Override Series.getDataParams()\n  getDataParams: function (dataIndex, dataType) {\n    var params = SankeySeries.superCall(this, 'getDataParams', dataIndex, dataType);\n\n    if (params.value == null && dataType === 'node') {\n      var node = this.getGraph().getNodeByIndex(dataIndex);\n      var nodeValue = node.getLayout().value;\n      params.value = nodeValue;\n    }\n\n    return params;\n  },\n  defaultOption: {\n    zlevel: 0,\n    z: 2,\n    coordinateSystem: 'view',\n    layout: null,\n    // The position of the whole view\n    left: '5%',\n    top: '5%',\n    right: '20%',\n    bottom: '5%',\n    // Value can be 'vertical'\n    orient: 'horizontal',\n    // The dx of the node\n    nodeWidth: 20,\n    // The vertical distance between two nodes\n    nodeGap: 8,\n    // Control if the node can move or not\n    draggable: true,\n    // Value can be 'inEdges', 'outEdges', 'allEdges', true (the same as 'allEdges').\n    focusNodeAdjacency: false,\n    // The number of iterations to change the position of the node\n    layoutIterations: 32,\n    label: {\n      show: true,\n      position: 'right',\n      color: '#000',\n      fontSize: 12\n    },\n    levels: [],\n    // Value can be 'left' or 'right'\n    nodeAlign: 'justify',\n    itemStyle: {\n      borderWidth: 1,\n      borderColor: '#333'\n    },\n    lineStyle: {\n      color: '#314656',\n      opacity: 0.2,\n      curveness: 0.5\n    },\n    emphasis: {\n      label: {\n        show: true\n      },\n      lineStyle: {\n        opacity: 0.5\n      }\n    },\n    animationEasing: 'linear',\n    animationDuration: 1000\n  }\n});\nvar _default = SankeySeries;\nmodule.exports = _default;","\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\nvar echarts = require(\"../../echarts\");\n\n/*\n* Licensed to the Apache Software Foundation (ASF) under one\n* or more contributor license agreements.  See the NOTICE file\n* distributed with this work for additional information\n* regarding copyright ownership.  The ASF licenses this file\n* to you under the Apache License, Version 2.0 (the\n* \"License\"); you may not use this file except in compliance\n* with the License.  You may obtain a copy of the License at\n*\n*   http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing,\n* software distributed under the License is distributed on an\n* \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n* KIND, either express or implied.  See the License for the\n* specific language governing permissions and limitations\n* under the License.\n*/\n\n/**\n * @payload\n * @property {number} [seriesIndex]\n * @property {string} [seriesId]\n * @property {string} [seriesName]\n * @property {number} [dataIndex]\n */\necharts.registerAction({\n  type: 'focusNodeAdjacency',\n  event: 'focusNodeAdjacency',\n  update: 'series:focusNodeAdjacency'\n}, function () {});\n/**\n * @payload\n * @property {number} [seriesIndex]\n * @property {string} [seriesId]\n * @property {string} [seriesName]\n */\n\necharts.registerAction({\n  type: 'unfocusNodeAdjacency',\n  event: 'unfocusNodeAdjacency',\n  update: 'series:unfocusNodeAdjacency'\n}, function () {});","var $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar ownKeys = require('../internals/own-keys');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar createProperty = require('../internals/create-property');\n\n// `Object.getOwnPropertyDescriptors` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptors\n$({ target: 'Object', stat: true, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIndexedObject(object);\n    var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var index = 0;\n    var key, descriptor;\n    while (keys.length > index) {\n      descriptor = getOwnPropertyDescriptor(O, key = keys[index++]);\n      if (descriptor !== undefined) createProperty(result, key, descriptor);\n    }\n    return result;\n  }\n});\n","var $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar nativeGetOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar DESCRIPTORS = require('../internals/descriptors');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeGetOwnPropertyDescriptor(1); });\nvar FORCED = !DESCRIPTORS || FAILS_ON_PRIMITIVES;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\n$({ target: 'Object', stat: true, forced: FORCED, sham: !DESCRIPTORS }, {\n  getOwnPropertyDescriptor: function getOwnPropertyDescriptor(it, key) {\n    return nativeGetOwnPropertyDescriptor(toIndexedObject(it), key);\n  }\n});\n"],"sourceRoot":""}